<html>
  <title>Fetching Posts</title>

  <body>
    <ul class="posts"></ul>

    <button id="fetch-button">Fetch Posts</button>

    <template id="single-post">
      <li class="post-item">
        <h2></h2>
        <p></p>
        <button>DELETE</button>
      </li>
    </template>

    <script>
      const listElement = document.querySelector(".posts");
      const postTemplate = document.getElementById("single-post");
      const fetchButton = document.getElementById("fetch-button");

      function sendHttpRequest(method, url) {
        return new Promise((resolve, reject) => {
          console.log("Method and url in Promise are ", method, url);
          const xhr = new XMLHttpRequest();
          xhr.open(method, url);
          xhr.send();
          console.log("Request sent");
          xhr.responseType = "json";
          xhr.onload = () => {
            console.log("Received response", xhr.response);
            resolve(xhr.response);
          };
        });
      }

      async function fetchPosts() {
        const responseData = await sendHttpRequest(
          "GET",
          "https://jsonplaceholder.typicode.com/posts"
        );
        const listOfPosts = responseData;
        for (const post of listOfPosts) {
          const postEl = document.importNode(postTemplate.content, true);
          postEl.querySelector("h2").textContent = post.title.toUpperCase();
          postEl.querySelector("p").textContent = post.body;
          listElement.append(postEl);
        }
      }

      fetchButton.addEventListener("click", fetchPosts);
    </script>
  </body>
</html>
