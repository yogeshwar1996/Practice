{"version":3,"file":"share-place.551694c33e6641524617.js","sources":["webpack:///share-place.551694c33e6641524617.js"],"sourcesContent":["!function(e){var t={};function o(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,\"a\",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p=\"dist/assets/scripts/\",o(o.s=2)}([function(e,t,o){\"use strict\";o.d(t,\"a\",(function(){return n}));class n{constructor(e){this.render(e)}render(e){if(!google)return void alert(\"Could not load maps library - please try again later!\");const t=new google.maps.Map(document.getElementById(\"map\"),{center:e,zoom:16});new google.maps.Marker({position:e,map:t})}}},,function(e,t,o){\"use strict\";o.r(t);class n{constructor(e,t){this.fallbackText=t,this.contentTemplateEl=document.getElementById(e),this.modalTemplateEl=document.getElementById(\"modal-template\")}show(){if(\"content\"in document.createElement(\"template\")){const e=document.importNode(this.modalTemplateEl.content,!0);this.modalElement=e.querySelector(\".modal\"),this.backdropElement=e.querySelector(\".backdrop\");const t=document.importNode(this.contentTemplateEl.content,!0);this.modalElement.appendChild(t),document.body.insertAdjacentElement(\"afterbegin\",this.modalElement),document.body.insertAdjacentElement(\"afterbegin\",this.backdropElement)}else alert(this.fallbackText)}hide(){this.modalElement&&(document.body.removeChild(this.modalElement),document.body.removeChild(this.backdropElement),this.modalElement=null,this.backdropElement=null)}}var a=o(0);class r{constructor(){const e=document.querySelector(\"form\");this.addressInput=document.getElementById(\"address-input\");const t=document.getElementById(\"locate-btn\");this.shareBtn=document.getElementById(\"share-btn\"),this.googleAPIKeyButton=document.getElementById(\"google-map-api-key-submission-btn\"),this.sharedLinkInputElement=document.getElementById(\"share-link\"),this.googleAPIKeyInputElement=document.getElementById(\"google-map-api-key-input\"),t.addEventListener(\"click\",this.locateUserHandler.bind(this)),this.shareBtn.addEventListener(\"click\",this.sharePlaceHandler.bind(this)),e.addEventListener(\"submit\",this.findAddressHandler.bind(this)),this.googleAPIKeyInputElement.addEventListener(\"input\",()=>{const e=this.googleAPIKeyInputElement.value;e&&e.trim().length>0?this.googleAPIKeyButton.disabled=!1:this.googleAPIKeyButton.disabled=!0}),this.googleAPIKeyButton.addEventListener(\"click\",()=>{const e=this.googleAPIKeyInputElement.value,t=document.createElement(\"script\");t.src=\"https://maps.googleapis.com/maps/api/js?key=\".concat(e),document.head.append(t),localStorage.setItem(\"googleAPIKey\",e)})}selectPlace(e,t){console.log(\"Coordinated are \",e),console.log(\"Address is \",t),this.map?this.map.render(e):this.map=new a.a(e),this.shareBtn.disabled=!1,this.sharedLinkInputElement.value=\"\".concat(location.origin,\"/my-place?address=\").concat(encodeURI(t),\"&lat=\").concat(e.lat,\"&lng=\").concat(e.lng)}sharePlaceHandler(){navigator.clipboard&&navigator.clipboard.writeText(this.sharedLinkInputElement.value).then(()=>alert(\"Copied into clipboard\")).catch(e=>{console.log(\"Error copying to clipboard \",e)})}locateUserHandler(){if(!navigator.geolocation)return void alert(\"Location feature is not available in your browser - please use a more modern browser or manually enter an address.\");const e=new n(\"loading-modal-content\",\"Loading location - please wait!\");e.show(),navigator.geolocation.getCurrentPosition(async t=>{const o={lat:t.coords.latitude,lng:t.coords.longitude};let n;try{n=await async function(e){const t=localStorage.getItem(\"googleAPIKey\"),o=await fetch(\"https://maps.googleapis.com/maps/api/geocode/json?latlng=\".concat(e.lat,\",\").concat(e.lng,\"&key=\").concat(t));if(!o.ok)throw new Error(\"Failed to fetch address. Please try again!\");const n=await o.json();if(n.error_message)throw new Error(n.error_message);return n.results[0].formatted_address}(o),this.addressInput.value=n,this.selectPlace(o,n)}catch(e){console.log(\"Error getting address from coordinates \",e)}e.hide()},t=>{e.hide(),alert(\"Could not locate you unfortunately. Please enter an address manually!\")})}async findAddressHandler(e){e.preventDefault();const t=e.target.querySelector(\"input\").value;if(!t||0===t.trim().length)return void alert(\"Invalid address entered - please try again!\");const o=new n(\"loading-modal-content\",\"Loading location - please wait!\");o.show();try{const e=await async function(e){const t=localStorage.getItem(\"googleAPIKey\"),o=encodeURI(e),n=await fetch(\"https://maps.googleapis.com/maps/api/geocode/json?address=\".concat(o,\"&key=\").concat(t));if(!n.ok)throw new Error(\"Failed to fetch coordinates. Please try again!\");const a=await n.json();if(a.error_message)throw new Error(a.error_message);return a.results[0].geometry.location}(t);this.selectPlace(e,t)}catch(e){alert(e.message)}o.hide()}}const l=localStorage.getItem(\"googleAPIKey\"),s=document.createElement(\"script\");s.src=\"https://maps.googleapis.com/maps/api/js?key=\".concat(l),document.head.append(s),s.onload=function(){console.log(\"Google Script loaded for Shareplace.js\");new r}}]);"],"mappings":"AAAA","sourceRoot":""}